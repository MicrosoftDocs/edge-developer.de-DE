---
description: Use the standards-based Chakra JavaScript engine to add scripting capabilities to your Windows application.
title: Hosting the JavaScript Runtime
ms.date: 06/18/2020
ms.prod: microsoft-edge
ms.topic: article
ms.assetid: 30ec744e-57cc-4ef5-8fe1-d2c27b946548
caps.latest.revision: 14
author: MSEdgeTeam
ms.author: msedgedevrel
ms.openlocfilehash: 043f7ecd174515ce407d2fc0c2bbe796fa2750a5
ms.sourcegitcommit: 037a2d62333691104c9accb4862968f80a3465a2
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 06/18/2020
ms.locfileid: "10752248"
---
# <span data-ttu-id="a54ff-103">Hosting the JavaScript runtime</span><span class="sxs-lookup"><span data-stu-id="a54ff-103">Hosting the JavaScript runtime</span></span>  

[!INCLUDE [deprecation-note](../includes/deprecation-note.md)]  

<span data-ttu-id="a54ff-104">The JavaScript Runtime (JsRT) APIs provide a way for desktop, Windows Store, and server-side applications running on the Windows operating system to add scripting capabilities to the application by using the standards-based Chakra JavaScript engine that is also utilized by Microsoft Edge and Internet Explorer.</span><span class="sxs-lookup"><span data-stu-id="a54ff-104">The JavaScript Runtime (JsRT) APIs provide a way for desktop, Windows Store, and server-side applications running on the Windows operating system to add scripting capabilities to the application by using the standards-based Chakra JavaScript engine that is also utilized by Microsoft Edge and Internet Explorer.</span></span> <span data-ttu-id="a54ff-105">These APIs are available on Windows 10 and any version of the Windows operating system that has Internet Explorer version 11.0 installed on the machine.</span><span class="sxs-lookup"><span data-stu-id="a54ff-105">These APIs are available on Windows 10 and any version of the Windows operating system that has Internet Explorer version 11.0 installed on the machine.</span></span> <span data-ttu-id="a54ff-106">For more info, see [Reference (JavaScript Runtime)](../chakra-hosting/reference-javascript-runtime.md).</span><span class="sxs-lookup"><span data-stu-id="a54ff-106">For more info, see [Reference (JavaScript Runtime)](../chakra-hosting/reference-javascript-runtime.md).</span></span> <span data-ttu-id="a54ff-107">For info on using the JsRT in Windows Store apps, see [JsRT and the Universal Windows Platform](#Windows).</span><span class="sxs-lookup"><span data-stu-id="a54ff-107">For info on using the JsRT in Windows Store apps, see [JsRT and the Universal Windows Platform](#Windows).</span></span>  

> [!NOTE]
> <span data-ttu-id="a54ff-108">This documentation assumes a general working familiarity with the JavaScript language.</span><span class="sxs-lookup"><span data-stu-id="a54ff-108">This documentation assumes a general working familiarity with the JavaScript language.</span></span>  

## <span data-ttu-id="a54ff-109">Concepts</span><span class="sxs-lookup"><span data-stu-id="a54ff-109">Concepts</span></span>  

<span data-ttu-id="a54ff-110">Understanding how to host the JavaScript engine using the JsRT APIs depends on two key concepts: runtimes and execution contexts.</span><span class="sxs-lookup"><span data-stu-id="a54ff-110">Understanding how to host the JavaScript engine using the JsRT APIs depends on two key concepts: runtimes and execution contexts.</span></span>  

<span data-ttu-id="a54ff-111">A *runtime* represents a complete JavaScript execution environment.</span><span class="sxs-lookup"><span data-stu-id="a54ff-111">A *runtime* represents a complete JavaScript execution environment.</span></span> <span data-ttu-id="a54ff-112">Each runtime that is created has its own isolated garbage collected heap and, by default, its own just-in-time (JIT) compiler thread and garbage collector (GC) thread.</span><span class="sxs-lookup"><span data-stu-id="a54ff-112">Each runtime that is created has its own isolated garbage collected heap and, by default, its own just-in-time (JIT) compiler thread and garbage collector (GC) thread.</span></span> <span data-ttu-id="a54ff-113">An *execution context* represents a JavaScript environment that has its own JavaScript global object distinct from all other execution contexts.</span><span class="sxs-lookup"><span data-stu-id="a54ff-113">An *execution context* represents a JavaScript environment that has its own JavaScript global object distinct from all other execution contexts.</span></span> <span data-ttu-id="a54ff-114">One runtime may contain multiple execution contexts, and in such cases, all the execution contexts share the JIT compiler and GC thread associated with the runtime.</span><span class="sxs-lookup"><span data-stu-id="a54ff-114">One runtime may contain multiple execution contexts, and in such cases, all the execution contexts share the JIT compiler and GC thread associated with the runtime.</span></span>  

<span data-ttu-id="a54ff-115">Runtimes represent a single thread of execution.</span><span class="sxs-lookup"><span data-stu-id="a54ff-115">Runtimes represent a single thread of execution.</span></span> <span data-ttu-id="a54ff-116">Only one runtime can be active on a particular thread at a time, and a runtime can only be active on one thread at a time.</span><span class="sxs-lookup"><span data-stu-id="a54ff-116">Only one runtime can be active on a particular thread at a time, and a runtime can only be active on one thread at a time.</span></span> <span data-ttu-id="a54ff-117">Runtimes are rental threaded, so a runtime that is not currently active on a thread (i.e. isn't running any JavaScript code or responding to any calls from the host) can be used on any thread that doesn't already have an active runtime on it.</span><span class="sxs-lookup"><span data-stu-id="a54ff-117">Runtimes are rental threaded, so a runtime that is not currently active on a thread (i.e. isn't running any JavaScript code or responding to any calls from the host) can be used on any thread that doesn't already have an active runtime on it.</span></span>  

<span data-ttu-id="a54ff-118">Execution contexts are tied to a particular runtime and execute code within that runtime.</span><span class="sxs-lookup"><span data-stu-id="a54ff-118">Execution contexts are tied to a particular runtime and execute code within that runtime.</span></span> <span data-ttu-id="a54ff-119">Unlike runtimes, multiple execution contexts can be active on a thread at the same time.</span><span class="sxs-lookup"><span data-stu-id="a54ff-119">Unlike runtimes, multiple execution contexts can be active on a thread at the same time.</span></span> <span data-ttu-id="a54ff-120">So a host can make a call into an execution context, that execution context can call back to the host, and the host can make a call into a different execution context.</span><span class="sxs-lookup"><span data-stu-id="a54ff-120">So a host can make a call into an execution context, that execution context can call back to the host, and the host can make a call into a different execution context.</span></span>  

![Multiple Execution Contexts](../chakra-hosting/media/js-chakra-hosting.png "JS_Chakra_Hosting")  

<span data-ttu-id="a54ff-122">In practice, unless a host needs to run code in separated environments, a single execution context can be used.</span><span class="sxs-lookup"><span data-stu-id="a54ff-122">In practice, unless a host needs to run code in separated environments, a single execution context can be used.</span></span> <span data-ttu-id="a54ff-123">Similarly, unless a host needs to run multiple pieces of code concurrently, a single runtime is sufficient.</span><span class="sxs-lookup"><span data-stu-id="a54ff-123">Similarly, unless a host needs to run multiple pieces of code concurrently, a single runtime is sufficient.</span></span>  

## <span data-ttu-id="a54ff-124">Memory management</span><span class="sxs-lookup"><span data-stu-id="a54ff-124">Memory management</span></span>  

<span data-ttu-id="a54ff-125">JavaScript is a garbage collected language, and thus there are several considerations that must be kept in mind when working with the JsRT APIs from another language.</span><span class="sxs-lookup"><span data-stu-id="a54ff-125">JavaScript is a garbage collected language, and thus there are several considerations that must be kept in mind when working with the JsRT APIs from another language.</span></span>  

<span data-ttu-id="a54ff-126">The main consideration is that the JavaScript garbage collector can only see references to values in two places: its runtime's heap, and the stack.</span><span class="sxs-lookup"><span data-stu-id="a54ff-126">The main consideration is that the JavaScript garbage collector can only see references to values in two places: its runtime's heap, and the stack.</span></span> <span data-ttu-id="a54ff-127">Thus, a reference to a JavaScript value that is stored inside of another JavaScript value or in a local variable on the stack will always be seen by the garbage collector.</span><span class="sxs-lookup"><span data-stu-id="a54ff-127">Thus, a reference to a JavaScript value that is stored inside of another JavaScript value or in a local variable on the stack will always be seen by the garbage collector.</span></span> <span data-ttu-id="a54ff-128">But references stored in other locations, such as heaps managed by the host or the system, will not be seen by the garbage collector and may result in premature collection of values that are still in use by the host.</span><span class="sxs-lookup"><span data-stu-id="a54ff-128">But references stored in other locations, such as heaps managed by the host or the system, will not be seen by the garbage collector and may result in premature collection of values that are still in use by the host.</span></span>  

> [!IMPORTANT]
> <span data-ttu-id="a54ff-129">Some language compilers (such as the Visual Studio C++ compiler) will optimize away local variables where possible.</span><span class="sxs-lookup"><span data-stu-id="a54ff-129">Some language compilers (such as the Visual Studio C++ compiler) will optimize away local variables where possible.</span></span> <span data-ttu-id="a54ff-130">Care must be taken to ensure that local variables that reference JavaScript values are on the stack if they are expected to keep those values alive.</span><span class="sxs-lookup"><span data-stu-id="a54ff-130">Care must be taken to ensure that local variables that reference JavaScript values are on the stack if they are expected to keep those values alive.</span></span>  

<span data-ttu-id="a54ff-131">If a reference to a JavaScript value will be stored in a location not visible to the garbage collector, the host must manually add and remove references using the JsRT APIs.</span><span class="sxs-lookup"><span data-stu-id="a54ff-131">If a reference to a JavaScript value will be stored in a location not visible to the garbage collector, the host must manually add and remove references using the JsRT APIs.</span></span>  

## <span data-ttu-id="a54ff-132">Exception handling</span><span class="sxs-lookup"><span data-stu-id="a54ff-132">Exception handling</span></span>  

<span data-ttu-id="a54ff-133">When a JavaScript exception occurs during script execution, the containing runtime is put into an exception state.</span><span class="sxs-lookup"><span data-stu-id="a54ff-133">When a JavaScript exception occurs during script execution, the containing runtime is put into an exception state.</span></span> <span data-ttu-id="a54ff-134">While in an exception state, no code can run and all API calls will fail with the error code `JsErrorInExceptionState` until the host retrieves and clears the exception using the `JsGetAndClearException` API.</span><span class="sxs-lookup"><span data-stu-id="a54ff-134">While in an exception state, no code can run and all API calls will fail with the error code `JsErrorInExceptionState` until the host retrieves and clears the exception using the `JsGetAndClearException` API.</span></span> <span data-ttu-id="a54ff-135">If the host returns from a JavaScript callback without clearing the runtime from an exception state, then the JavaScript exception will be re-thrown as soon as control passes back to the JavaScript engine.</span><span class="sxs-lookup"><span data-stu-id="a54ff-135">If the host returns from a JavaScript callback without clearing the runtime from an exception state, then the JavaScript exception will be re-thrown as soon as control passes back to the JavaScript engine.</span></span> <span data-ttu-id="a54ff-136">This also enables host callbacks to "throw" a JavaScript exception by setting the runtime into an exception state and then returning from a host callback.</span><span class="sxs-lookup"><span data-stu-id="a54ff-136">This also enables host callbacks to "throw" a JavaScript exception by setting the runtime into an exception state and then returning from a host callback.</span></span>  

<span data-ttu-id="a54ff-137">A host is not allowed to let its own internal exceptions to propagate across a host callback—any callback methods must catch all host exceptions before returning control to the runtime.</span><span class="sxs-lookup"><span data-stu-id="a54ff-137">A host is not allowed to let its own internal exceptions to propagate across a host callback—any callback methods must catch all host exceptions before returning control to the runtime.</span></span>  

## <span data-ttu-id="a54ff-138">Runtime resource usage</span><span class="sxs-lookup"><span data-stu-id="a54ff-138">Runtime resource usage</span></span>  

<span data-ttu-id="a54ff-139">The JsRT APIs expose a number of way to monitor and modify the way runtimes use resources.</span><span class="sxs-lookup"><span data-stu-id="a54ff-139">The JsRT APIs expose a number of way to monitor and modify the way runtimes use resources.</span></span> <span data-ttu-id="a54ff-140">They generally break down into the following categories:</span><span class="sxs-lookup"><span data-stu-id="a54ff-140">They generally break down into the following categories:</span></span>  

*   <span data-ttu-id="a54ff-141">**Thread Usage**.</span><span class="sxs-lookup"><span data-stu-id="a54ff-141">**Thread Usage**.</span></span> <span data-ttu-id="a54ff-142">By default, each runtime will create a dedicated JIT compiler thread and a dedicated GC thread that service that runtime.</span><span class="sxs-lookup"><span data-stu-id="a54ff-142">By default, each runtime will create a dedicated JIT compiler thread and a dedicated GC thread that service that runtime.</span></span> <span data-ttu-id="a54ff-143">If a runtime is created with the `JsRuntimeAttributeDisableBackgroundWork` flag, then the JIT and GC work will be performed on the runtime thread itself instead of separate background threads for each one of them.</span><span class="sxs-lookup"><span data-stu-id="a54ff-143">If a runtime is created with the `JsRuntimeAttributeDisableBackgroundWork` flag, then the JIT and GC work will be performed on the runtime thread itself instead of separate background threads for each one of them.</span></span> <span data-ttu-id="a54ff-144">A host can also supply a thread service callback to the `JsCreateRuntime` call, which will allow the host to schedule JIT and GC work in any way it sees fit.</span><span class="sxs-lookup"><span data-stu-id="a54ff-144">A host can also supply a thread service callback to the `JsCreateRuntime` call, which will allow the host to schedule JIT and GC work in any way it sees fit.</span></span>
*   <span data-ttu-id="a54ff-145">**Memory Usage**.</span><span class="sxs-lookup"><span data-stu-id="a54ff-145">**Memory Usage**.</span></span> <span data-ttu-id="a54ff-146">There are several ways to monitor and modify the memory usage of a runtime.</span><span class="sxs-lookup"><span data-stu-id="a54ff-146">There are several ways to monitor and modify the memory usage of a runtime.</span></span> <span data-ttu-id="a54ff-147">If the runtime will be running for a long time, the host can specify the `JsRuntimeAttributeEnableIdleProcessing` flag when creating the runtime and then call `JsIdle` when the host is in an idle state.</span><span class="sxs-lookup"><span data-stu-id="a54ff-147">If the runtime will be running for a long time, the host can specify the `JsRuntimeAttributeEnableIdleProcessing` flag when creating the runtime and then call `JsIdle` when the host is in an idle state.</span></span> <span data-ttu-id="a54ff-148">This allows the engine to defer some memory cleanup and bookkeeping work until idle time.</span><span class="sxs-lookup"><span data-stu-id="a54ff-148">This allows the engine to defer some memory cleanup and bookkeeping work until idle time.</span></span>  
    
    <span data-ttu-id="a54ff-149">The host can monitor garbage collections by calling `JsSetRuntimeBeforeCollectCallback`.</span><span class="sxs-lookup"><span data-stu-id="a54ff-149">The host can monitor garbage collections by calling `JsSetRuntimeBeforeCollectCallback`.</span></span> <span data-ttu-id="a54ff-150">It can also monitor allocations made by the heap by calling `JsSetRuntimeMemoryAllocationCallback`.</span><span class="sxs-lookup"><span data-stu-id="a54ff-150">It can also monitor allocations made by the heap by calling `JsSetRuntimeMemoryAllocationCallback`.</span></span> <span data-ttu-id="a54ff-151">Note that this API does not call back on every JavaScript allocation, just when the runtime's heap needs more space from which to allocate.</span><span class="sxs-lookup"><span data-stu-id="a54ff-151">Note that this API does not call back on every JavaScript allocation, just when the runtime's heap needs more space from which to allocate.</span></span> <span data-ttu-id="a54ff-152">The memory allocation callback is allowed to deny the request, which will trigger a garbage collection and, if no memory is available, an out of memory error in the runtime.</span><span class="sxs-lookup"><span data-stu-id="a54ff-152">The memory allocation callback is allowed to deny the request, which will trigger a garbage collection and, if no memory is available, an out of memory error in the runtime.</span></span>  
    
    <span data-ttu-id="a54ff-153">The host can also call `JsSetRuntimeMemoryLimit` to set a limit for how much memory a runtime can use.</span><span class="sxs-lookup"><span data-stu-id="a54ff-153">The host can also call `JsSetRuntimeMemoryLimit` to set a limit for how much memory a runtime can use.</span></span> <span data-ttu-id="a54ff-154">When a runtime hits a limit, it will trigger a garbage collection and, if no memory is available, an out of memory error will be thrown by the runtime.</span><span class="sxs-lookup"><span data-stu-id="a54ff-154">When a runtime hits a limit, it will trigger a garbage collection and, if no memory is available, an out of memory error will be thrown by the runtime.</span></span>  
    
*   <span data-ttu-id="a54ff-155">**Script Interruption and Evaluation**.</span><span class="sxs-lookup"><span data-stu-id="a54ff-155">**Script Interruption and Evaluation**.</span></span> <span data-ttu-id="a54ff-156">The host can call `JsDisableRuntimeExecution` to terminate execution within a runtime.</span><span class="sxs-lookup"><span data-stu-id="a54ff-156">The host can call `JsDisableRuntimeExecution` to terminate execution within a runtime.</span></span> <span data-ttu-id="a54ff-157">This call can be made at any time and from any thread.</span><span class="sxs-lookup"><span data-stu-id="a54ff-157">This call can be made at any time and from any thread.</span></span> <span data-ttu-id="a54ff-158">Because script termination depends on reaching guard points inserted into the code, a script may not terminate at the exact moment, but will do so very shortly afterwards.</span><span class="sxs-lookup"><span data-stu-id="a54ff-158">Because script termination depends on reaching guard points inserted into the code, a script may not terminate at the exact moment, but will do so very shortly afterwards.</span></span> <span data-ttu-id="a54ff-159">By default, termination guard points are placed in the generated code conservatively and may not cover every situation, such as an infinite loop.</span><span class="sxs-lookup"><span data-stu-id="a54ff-159">By default, termination guard points are placed in the generated code conservatively and may not cover every situation, such as an infinite loop.</span></span> <span data-ttu-id="a54ff-160">Creating the runtime with the `JsRuntimeAttributeAllowScriptInterrupt` flag causes the runtime to insert additional checks for infinite loops, often at the cost of a small performance overhead.</span><span class="sxs-lookup"><span data-stu-id="a54ff-160">Creating the runtime with the `JsRuntimeAttributeAllowScriptInterrupt` flag causes the runtime to insert additional checks for infinite loops, often at the cost of a small performance overhead.</span></span>  
    
    <span data-ttu-id="a54ff-161">If a host wishes to disallow generation of native code by the JIT compiler, it can specify the `JsRuntimeAttributeDisableNativeCodeGeneration` flag.</span><span class="sxs-lookup"><span data-stu-id="a54ff-161">If a host wishes to disallow generation of native code by the JIT compiler, it can specify the `JsRuntimeAttributeDisableNativeCodeGeneration` flag.</span></span> <span data-ttu-id="a54ff-162">A host can also disallow scripts from dynamically running scripts itself by specifying the `JsRuntimeAttributeDisableEval` flag.</span><span class="sxs-lookup"><span data-stu-id="a54ff-162">A host can also disallow scripts from dynamically running scripts itself by specifying the `JsRuntimeAttributeDisableEval` flag.</span></span>  
    
## <span data-ttu-id="a54ff-163">Debugging and profiling</span><span class="sxs-lookup"><span data-stu-id="a54ff-163">Debugging and profiling</span></span>  

<span data-ttu-id="a54ff-164">JsRT APIs supports debugging and profiling via the Active Scripting technology.</span><span class="sxs-lookup"><span data-stu-id="a54ff-164">JsRT APIs supports debugging and profiling via the Active Scripting technology.</span></span>  

<span data-ttu-id="a54ff-165">Starting in Windows 10, the Chakra JavaScript Engine supports the legacy Internet Explorer (MSHTML) engine and new Microsoft Edge (EdgeHTML) engine, and you can target either in JsRT (see [Targeting Microsoft Edge vs. Legacy Engines](../chakra-hosting/targeting-edge-vs-legacy-engines-in-jsrt-apis.md) for details).</span><span class="sxs-lookup"><span data-stu-id="a54ff-165">Starting in Windows 10, the Chakra JavaScript Engine supports the legacy Internet Explorer (MSHTML) engine and new Microsoft Edge (EdgeHTML) engine, and you can target either in JsRT (see [Targeting Microsoft Edge vs. Legacy Engines](../chakra-hosting/targeting-edge-vs-legacy-engines-in-jsrt-apis.md) for details).</span></span> <span data-ttu-id="a54ff-166">Debugging a script in Visual Studio works differently between the legacy engine and Microsoft Edge engine.</span><span class="sxs-lookup"><span data-stu-id="a54ff-166">Debugging a script in Visual Studio works differently between the legacy engine and Microsoft Edge engine.</span></span> <span data-ttu-id="a54ff-167">With the legacy engine, the host needs to provide an [IDebugApplication Interface](/scripting/winscript/reference/idebugapplication-interface) pointer, which can be obtained from an [IProcessDebugManager Interface](/scripting/winscript/reference/iprocessdebugmanager-interface) instance.</span><span class="sxs-lookup"><span data-stu-id="a54ff-167">With the legacy engine, the host needs to provide an [IDebugApplication Interface](/scripting/winscript/reference/idebugapplication-interface) pointer, which can be obtained from an [IProcessDebugManager Interface](/scripting/winscript/reference/iprocessdebugmanager-interface) instance.</span></span> <span data-ttu-id="a54ff-168">With the Microsoft Edge engine, `IDebugApplication` is deprecated, and the Chakra engine enables native and script debugging capabilities through the Visual Studio debugger without requiring an implementation of `IDebugApplication` from the user.</span><span class="sxs-lookup"><span data-stu-id="a54ff-168">With the Microsoft Edge engine, `IDebugApplication` is deprecated, and the Chakra engine enables native and script debugging capabilities through the Visual Studio debugger without requiring an implementation of `IDebugApplication` from the user.</span></span>  

<span data-ttu-id="a54ff-169">To make scripts in an execution context debuggable, the Chakra engine has to switch to using less efficient code execution methods.</span><span class="sxs-lookup"><span data-stu-id="a54ff-169">To make scripts in an execution context debuggable, the Chakra engine has to switch to using less efficient code execution methods.</span></span> <span data-ttu-id="a54ff-170">As such, debuggable code typically runs slower than non-debuggable code.</span><span class="sxs-lookup"><span data-stu-id="a54ff-170">As such, debuggable code typically runs slower than non-debuggable code.</span></span> <span data-ttu-id="a54ff-171">As a result, with the legacy engine, a host can choose to either start debugging in an execution context from the beginning by providing the `IDebugApplication` pointer up front through `JsCreateContext`, or it can wait until debugging is needed and then call `JsStartDebugging`.</span><span class="sxs-lookup"><span data-stu-id="a54ff-171">As a result, with the legacy engine, a host can choose to either start debugging in an execution context from the beginning by providing the `IDebugApplication` pointer up front through `JsCreateContext`, or it can wait until debugging is needed and then call `JsStartDebugging`.</span></span> <span data-ttu-id="a54ff-172">With the Microsoft Edge engine, `JsCreateContext` no longer takes an `IDebugApplication` parameter, and as a result the script is debuggable only after `JsStartDebugging` is called.</span><span class="sxs-lookup"><span data-stu-id="a54ff-172">With the Microsoft Edge engine, `JsCreateContext` no longer takes an `IDebugApplication` parameter, and as a result the script is debuggable only after `JsStartDebugging` is called.</span></span> <span data-ttu-id="a54ff-173">When debugging using Visual Studio, the "Script" debugger option must be enabled.</span><span class="sxs-lookup"><span data-stu-id="a54ff-173">When debugging using Visual Studio, the "Script" debugger option must be enabled.</span></span>  

<span data-ttu-id="a54ff-174">The JavaScript code in an execution context can be profiled in one of two ways.</span><span class="sxs-lookup"><span data-stu-id="a54ff-174">The JavaScript code in an execution context can be profiled in one of two ways.</span></span> <span data-ttu-id="a54ff-175">The command line Visual Studio Profiler (vsperf.exe) can be used in Windows 8.1 and later versions with the /js switch to produce a report that targets the JavaScript code run in the application.</span><span class="sxs-lookup"><span data-stu-id="a54ff-175">The command line Visual Studio Profiler (vsperf.exe) can be used in Windows 8.1 and later versions with the /js switch to produce a report that targets the JavaScript code run in the application.</span></span> <span data-ttu-id="a54ff-176">Or the host can directly call `JsStartProfiling` and `JsStopProfiling` and provide a callback to do profiling itself.</span><span class="sxs-lookup"><span data-stu-id="a54ff-176">Or the host can directly call `JsStartProfiling` and `JsStopProfiling` and provide a callback to do profiling itself.</span></span> <span data-ttu-id="a54ff-177">The host can also examine the state of the garbage collected heap by calling `JsEnumerateHeap`.</span><span class="sxs-lookup"><span data-stu-id="a54ff-177">The host can also examine the state of the garbage collected heap by calling `JsEnumerateHeap`.</span></span> <span data-ttu-id="a54ff-178">Profiling in JsRT works in the same manner between the legacy and the Microsoft Edge engine.</span><span class="sxs-lookup"><span data-stu-id="a54ff-178">Profiling in JsRT works in the same manner between the legacy and the Microsoft Edge engine.</span></span> <span data-ttu-id="a54ff-179">However, JsRT profiling APIs (`JsStartProfiling`, `JsStopProfiling`, `JsEnumerateHeap`, and `JsIsEnumeratingHeap`) are not available for Universal Windows Apps.</span><span class="sxs-lookup"><span data-stu-id="a54ff-179">However, JsRT profiling APIs (`JsStartProfiling`, `JsStopProfiling`, `JsEnumerateHeap`, and `JsIsEnumeratingHeap`) are not available for Universal Windows Apps.</span></span>  

<a name="Windows"></a>   

## <span data-ttu-id="a54ff-180">JsRT and the Universal Windows Platform</span><span class="sxs-lookup"><span data-stu-id="a54ff-180">JsRT and the Universal Windows Platform</span></span>  

<span data-ttu-id="a54ff-181">You can use JsRT APIs to add scripting capabilities to a Universal Windows app.</span><span class="sxs-lookup"><span data-stu-id="a54ff-181">You can use JsRT APIs to add scripting capabilities to a Universal Windows app.</span></span> <span data-ttu-id="a54ff-182">A Universal Windows app that uses the JsRT APIs will need to target the Microsoft Edge JSRT APIs, which in turn target the Edge Chakra engine.</span><span class="sxs-lookup"><span data-stu-id="a54ff-182">A Universal Windows app that uses the JsRT APIs will need to target the Microsoft Edge JSRT APIs, which in turn target the Edge Chakra engine.</span></span> <span data-ttu-id="a54ff-183">For more information, see [Targeting Microsoft Edge vs. Legacy Engines](../chakra-hosting/targeting-edge-vs-legacy-engines-in-jsrt-apis.md).</span><span class="sxs-lookup"><span data-stu-id="a54ff-183">For more information, see [Targeting Microsoft Edge vs. Legacy Engines](../chakra-hosting/targeting-edge-vs-legacy-engines-in-jsrt-apis.md).</span></span> <span data-ttu-id="a54ff-184">The complete JsRT API is available for Universal Windows apps, except for profiling and heap enumeration support (`JsStartProfiling`, `JsStopProfiling`, `JsEnumerateHeap`, and `JsIsEnumeratingHeap` are not supported).</span><span class="sxs-lookup"><span data-stu-id="a54ff-184">The complete JsRT API is available for Universal Windows apps, except for profiling and heap enumeration support (`JsStartProfiling`, `JsStopProfiling`, `JsEnumerateHeap`, and `JsIsEnumeratingHeap` are not supported).</span></span>  

<span data-ttu-id="a54ff-185">JsRT also allows scripts to natively access any [Universal Windows Platform (UWP) APIs](https://msdn.microsoft.com/library/windows/apps/br211377.aspx) after exposing the API namespace through Microsoft Edge JsRT API `JsProjectWinRTNamespace`.</span><span class="sxs-lookup"><span data-stu-id="a54ff-185">JsRT also allows scripts to natively access any [Universal Windows Platform (UWP) APIs](https://msdn.microsoft.com/library/windows/apps/br211377.aspx) after exposing the API namespace through Microsoft Edge JsRT API `JsProjectWinRTNamespace`.</span></span> <span data-ttu-id="a54ff-186">While Universal Windows Applications require no setup in addition to projecting necessary namespaces, in a Classic (Win32) Windows Application, a COM-initialized delegated pumping mechanism needs to be enabled through `JsSetProjectionEnqueueCallback` to enable events and asynchronous APIs.</span><span class="sxs-lookup"><span data-stu-id="a54ff-186">While Universal Windows Applications require no setup in addition to projecting necessary namespaces, in a Classic (Win32) Windows Application, a COM-initialized delegated pumping mechanism needs to be enabled through `JsSetProjectionEnqueueCallback` to enable events and asynchronous APIs.</span></span> <span data-ttu-id="a54ff-187">The following Win32 sample utilizes asynchronous UWP APIs to create an http client to get content from a Uri:</span><span class="sxs-lookup"><span data-stu-id="a54ff-187">The following Win32 sample utilizes asynchronous UWP APIs to create an http client to get content from a Uri:</span></span>  

```cpp
typedef struct _jsCall {
    JsProjectionCallback jsCallback;
    JsProjectionCallbackContext jsContext;
    HANDLE event;
} jsCall;

// Set up delegated pumping mechanism; not necessary in UWP applications.
jsCall outstandingCall = {};
CoInitializeEx(nullptr, COINIT_MULTITHREADED);
JsSetProjectionEnqueueCallback([](JsProjectionCallback jsCallback,
JsProjectionCallbackContext jsContext, void *callbackState) {
    jsCall* call = (jsCall*)callbackState;
    call->jsCallback = jsCallback;
    call->jsContext = jsContext;
    SetEvent(call->event);
    },
&outstandingCall);
HANDLE event = CreateEventEx(NULL, NULL, CREATE_EVENT_MANUAL_RESET, EVENT_ALL_ACCESS);
outstandingCall.event = event;

// Project necessary namespaces.
JsProjectWinRTNamespace(L"Windows.Foundation");
JsProjectWinRTNamespace(L"Windows.Web");

// Get content from an Uri.
JsRunScript(L"var uri = new Windows.Foundation.Uri(\"http://somedatasource.com\"); " \
    L"var httpClient = new Windows.Web.Http.HttpClient();" \
    L"httpClient.getStringAsync(uri).done(function (content) { " \
    L"    // do something with the string content " \
    L"}, onError); " \
    L"function onError(reason) { " \
    L"    // error handling " \
    L"}",
    currentSourceContext, L"", &result);

// Wait for async call to come in and then execute; not necessary in UWP applications.
WaitForSingleObjectEx(outstandingCall.event, 10000, FALSE) == WAIT_OBJECT_0;
outstandingCall.jsCallback(outstandingCall.jsContext);
```  

## <span data-ttu-id="a54ff-188">See also</span><span class="sxs-lookup"><span data-stu-id="a54ff-188">See also</span></span>  

*   [<span data-ttu-id="a54ff-189">JavaScript Runtime Sample App</span><span class="sxs-lookup"><span data-stu-id="a54ff-189">JavaScript Runtime Sample App</span></span>](https://go.microsoft.com/fwlink/p/?LinkID=306674&clcid=0x409)   
*   [<span data-ttu-id="a54ff-190">Reference (JavaScript Runtime)</span><span class="sxs-lookup"><span data-stu-id="a54ff-190">Reference (JavaScript Runtime)</span></span>](../chakra-hosting/reference-javascript-runtime.md)   
*   [<span data-ttu-id="a54ff-191">JavaScript Runtime Hosting</span><span class="sxs-lookup"><span data-stu-id="a54ff-191">JavaScript Runtime Hosting</span></span>](../javascript-runtime-hosting.md)  
